"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4747],{8327:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"guides/code-snippets","title":"Extract Code Snippets","description":"Do you prefer learning through videos? Check out our video on","source":"@site/docs/guides/code-snippets.md","sourceDirName":"guides","slug":"/code-snippets/","permalink":"/Bluehawk/code-snippets/","draft":false,"unlisted":false,"editUrl":null,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"code-snippets","title":"Extract Code Snippets","slug":"/code-snippets/","sidebar_label":"Extract Code Snippets","sidebar_position":1,"custom_edit_url":null},"sidebar":"mainSidebar","previous":{"title":"Use Cases","permalink":"/Bluehawk/use-cases"},"next":{"title":"Checkpointed Tutorials","permalink":"/Bluehawk/tutorials/"}}');var a=t(4848),i=t(8453);const r={id:"code-snippets",title:"Extract Code Snippets",slug:"/code-snippets/",sidebar_label:"Extract Code Snippets",sidebar_position:1,custom_edit_url:null},o=void 0,l={},d=[{value:"Annotate Unit Tests",id:"annotate-unit-tests",level:2},{value:"Output File Names",id:"output-file-names",level:3},{value:"Example Unit Test Annotation",id:"example-unit-test-annotation",level:3},{value:"Snippet start and end",id:"snippet-start-and-end",level:4},{value:"Remove code",id:"remove-code",level:4},{value:"Replace",id:"replace",level:4},{value:"Use the CLI to Extract Snippets",id:"use-the-cli-to-extract-snippets",level:2},{value:"Extract Code from a Single File",id:"extract-code-from-a-single-file",level:3},{value:"Extract Code in a Directory",id:"extract-code-in-a-directory",level:3},{value:"Include the Snippets In Your Documentation",id:"include-the-snippets-in-your-documentation",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["Do you prefer learning through videos? Check out our video on\n",(0,a.jsx)(n.a,{href:"/#extract-and-generate-code-examples",children:"Extract and Generate Code Examples"})]})}),"\n",(0,a.jsx)(n.h2,{id:"annotate-unit-tests",children:"Annotate Unit Tests"}),"\n",(0,a.jsxs)(n.p,{children:["The first step to use Bluehawk is to annotate your unit tests with\n",(0,a.jsx)(n.a,{href:"/reference/tags",children:"Bluehawk tags"}),". Tags are similar to HTML or XML; you\nput a ",(0,a.jsx)(n.code,{children:"start"})," tag before the code you want to annotate, and an ",(0,a.jsx)(n.code,{children:"end"})," tag\nafter it. Bluehawk reads those start and end tags, and generates output\nfiles based on your annotations. You can use Bluehawk tags in any text file."]}),"\n",(0,a.jsx)(n.p,{children:'The Bluehawk tool has language-specific "comment awareness" - as well as\nstring literal awareness - that allows it to:'}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Avoid making snippet files with a closing block comment token at the front"}),"\n",(0,a.jsx)(n.li,{children:'Parse multi-line, commented out JSON "attribute lists" of tags so they\ndon\'t create syntax errors in your code'}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["There is not currently a way to find out which languages Bluehawk supports\nfrom the CLI. However, you can see the ",(0,a.jsx)(n.a,{href:"https://github.com/mongodb-university/Bluehawk/blob/8bb5766e5f30182ed3992eae8f36dba8a8db99ba/src/bluehawk/getBluehawk.ts#L52",children:"supported file extensions in\nthe Bluehawk source"}),"\nto see if Bluehawk supports your preferred language."]}),"\n",(0,a.jsxs)(n.p,{children:["To request support for your language, ",(0,a.jsx)(n.a,{href:"https://github.com/mongodb-university/Bluehawk/issues",children:"file an issue in the Bluehawk\nrepository"}),", or\nmake a PR to add support for your preferred language."]}),"\n",(0,a.jsx)(n.h3,{id:"output-file-names",children:"Output File Names"}),"\n",(0,a.jsx)(n.p,{children:"When you start a Bluehawk code block tag, you append a descriptive title,\nsimilar to:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"// :snippet-start: person-model\n"})}),"\n",(0,a.jsx)(n.p,{children:"When you generate Bluehawk output, the output file name concatenates:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"The name of your unit test file"}),"\n",(0,a.jsxs)(n.li,{children:["The word ",(0,a.jsx)(n.code,{children:"snippet"})]}),"\n",(0,a.jsxs)(n.li,{children:["The descriptive name that you put in the ",(0,a.jsx)(n.code,{children:"snippet-start"})," tag"]}),"\n",(0,a.jsx)(n.li,{children:"The file type of your unit test file"}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["For this example, the code block is in a file called Models.swift, so\nthe generated output file name would be: ",(0,a.jsx)(n.code,{children:"Models.snippet.person-model.swift"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"example-unit-test-annotation",children:"Example Unit Test Annotation"}),"\n",(0,a.jsx)(n.h4,{id:"snippet-start-and-end",children:"Snippet start and end"}),"\n",(0,a.jsxs)(n.p,{children:["For this code snippet, we don't need to show the ",(0,a.jsx)(n.code,{children:"import"})," statement in our final\nexample, so we start the snippet after it. Then, after the code we want\nto show in our final example, we end the snippet."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'import RealmSwift\n\n// :snippet-start: person-model\nclass Person: Object {\n    // Required string property\n    @Persisted var name: String = ""\n\n    // Optional string property\n    @Persisted var address: String?\n\n    // Optional integral type property\n    @Persisted var age: Int?\n}\n// :snippet-end:\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The output file becomes ",(0,a.jsx)(n.code,{children:"Models.snippet.person-model.swift"}),". After we use the Bluehawk CLI to extract this code example, the final code example looks like this:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'class Person: Object {\n    // Required string property\n    @Persisted var name: String = ""\n\n    // Optional string property\n    @Persisted var address: String?\n\n    // Optional integral type property\n    @Persisted var age: Int?\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The output file includes only the lines of code between the ",(0,a.jsx)(n.code,{children:"snippet-start"}),"\nand the ",(0,a.jsx)(n.code,{children:"snippet-end"})," tags."]}),"\n",(0,a.jsx)(n.h4,{id:"remove-code",children:"Remove code"}),"\n",(0,a.jsx)(n.p,{children:"Bluehawk lets you to remove code that isn't relevant to your\ndocumentation viewers."}),"\n",(0,a.jsxs)(n.p,{children:["This example is from the ",(0,a.jsx)(n.a,{href:"https://github.com/mongodb/docs-realm/blob/master/examples/ios/Examples/ManageEmailPasswordUsers.swift",children:"ManageEmailPasswordUsers.swift"})," file in the Realm Docs iOS Unit Test suite."]}),"\n",(0,a.jsxs)(n.p,{children:["This uses the snippet start and end tags, but it also uses ",(0,a.jsx)(n.code,{children:"// :remove-start:"}),"\nand ",(0,a.jsx)(n.code,{children:"// :remove-end:"})," to remove elements of the code example. Here, we're\nremoving a test assertion in the ",(0,a.jsx)(n.code,{children:"catch"})," block that the documentation viewer\ndoesn't need to see. You might also use it to remove test setup or teardown code\nthat isn't relevant to your documentation viewers."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'    func testPasswordResetFunc() async {\n        // :snippet-start: password-reset-function\n        let app = App(id: YOUR_REALM_APP_ID)\n        let client = app.emailPasswordAuth\n\n        let email = "forgot.my.password@example.com"\n        let newPassword = "mynewpassword12345"\n        // The password reset function takes any number of\n        // arguments. You might ask the user to provide answers to\n        // security questions, for example, to verify the user\n        // should be able to complete the password reset.\n        let args: [AnyBSON] = []\n\n        // This SDK call maps to the custom password reset\n        // function that you define in the backend\n        do {\n            try await client.callResetPasswordFunction(email: email, password: newPassword, args: args)\n            print("Password reset successful!")\n        } catch {\n            print("Password reset failed: \\(error.localizedDescription)")\n            // :remove-start:\n            XCTAssertEqual(error.localizedDescription, "user not found")\n            // :remove-end:\n        }\n        // :snippet-end:\n    }\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The final output code example\n",(0,a.jsx)(n.code,{children:"ManageEmailPasswordUsers.snippet.password-reset-function.swift"}),"\nlooks like:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'let app = App(id: YOUR_REALM_APP_ID)\nlet client = app.emailPasswordAuth\n\nlet email = "forgot.my.password@example.com"\nlet newPassword = "mynewpassword12345"\n// The password reset function takes any number of\n// arguments. You might ask the user to provide answers to\n// security questions, for example, to verify the user\n// should be able to complete the password reset.\nlet args: [AnyBSON] = []\n\n// This SDK call maps to the custom password reset\n// function that you define in the backend\ndo {\n    try await client.callResetPasswordFunction(email: email, password: newPassword, args: args)\n    print("Password reset successful!")\n} catch {\n    print("Password reset failed: \\(error.localizedDescription)")\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"catch"})," block does not show the hidden assertion; it only shows the\nprint line."]}),"\n",(0,a.jsx)(n.h4,{id:"replace",children:"Replace"}),"\n",(0,a.jsxs)(n.p,{children:["Bluehawk gives you the ability to replace terms with different terms, or even\nnothing at all. In the Realm Docs iOS Unit Test suite, we use the ",(0,a.jsx)(n.code,{children:"replace"})," tag\nto remove awkward names we have to use to avoid namespace collisions. For\nexample:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// :replace-start: {\n//   "terms": {\n//     "ReadWriteDataExamples_": ""\n//   }\n// }\nimport XCTest\nimport RealmSwift\n\n// :snippet-start: models\nclass ReadWriteDataExamples_DogToy: Object {\n    @Persisted var name = ""\n}\n\nclass ReadWriteDataExamples_Dog: Object {\n    @Persisted var name = ""\n    @Persisted var age = 0\n    @Persisted var color = ""\n    @Persisted var currentCity = ""\n\n    // To-one relationship\n    @Persisted var favoriteToy: ReadWriteDataExamples_DogToy?\n}\n\nclass ReadWriteDataExamples_Person: Object {\n    @Persisted(primaryKey: true) var id = 0\n    @Persisted var name = ""\n\n    // To-many relationship - a person can have many dogs\n    @Persisted var dogs: List<ReadWriteDataExamples_Dog>\n\n    // Inverse relationship - a person can be a member of many clubs\n    @Persisted(originProperty: "members") var clubs: LinkingObjects<ReadWriteDataExamples_DogClub>\n}\n\nclass ReadWriteDataExamples_DogClub: Object {\n    @Persisted var name = ""\n    @Persisted var members: List<ReadWriteDataExamples_Person>\n}\n// :snippet-end:\n// Many more lines of code examples, until eventually, we end the replace\n// :replace-end:\n'})}),"\n",(0,a.jsxs)(n.p,{children:["As you can see, the model names such as ",(0,a.jsx)(n.code,{children:"ReadWriteDataExamples_DogToy"})," are\nvery awkward. The ",(0,a.jsx)(n.code,{children:"ReadWriteDataExamples"})," is present to avoid namespace\ncollisions with ",(0,a.jsx)(n.code,{children:"Dog"})," or ",(0,a.jsx)(n.code,{children:"Person"})," models in other test files. But this\nawkward name isn't something we want to show documentation viewers."]}),"\n",(0,a.jsxs)(n.p,{children:["Fortunately, replace lets us swap any instance of the term we specify with\nsome alternative. In this example, we replace ",(0,a.jsx)(n.code,{children:"ReadWriteDataExamples"}),"\nwith an empty string."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'// :replace-start: {\n//   "terms": {\n//     "ReadWriteDataExamples_": ""\n//   }\n// }\n'})}),"\n",(0,a.jsx)(n.p,{children:"The output file for the code block above looks like this:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-swift",children:'class DogToy: Object {\n    @Persisted var name = ""\n}\n\nclass Dog: Object {\n    @Persisted var name = ""\n    @Persisted var age = 0\n    @Persisted var color = ""\n    @Persisted var currentCity = ""\n\n    // To-one relationship\n    @Persisted var favoriteToy: DogToy?\n}\n\nclass Person: Object {\n    @Persisted(primaryKey: true) var id = 0\n    @Persisted var name = ""\n\n    // To-many relationship - a person can have many dogs\n    @Persisted var dogs: List<Dog>\n\n    // Inverse relationship - a person can be a member of many clubs\n    @Persisted(originProperty: "members") var clubs: LinkingObjects<DogClub>\n}\n\nclass DogClub: Object {\n    @Persisted var name = ""\n    @Persisted var members: List<Person>\n}\n'})}),"\n",(0,a.jsx)(n.p,{children:"The long, awkward name has been replaced with nothing."}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["Be careful with ",(0,a.jsx)(n.code,{children:"replace"}),". Use VerySpecificNamesAndCharacters_ here so\nyou can be sure you don't unintentionally delete something common."]})}),"\n",(0,a.jsx)(n.h2,{id:"use-the-cli-to-extract-snippets",children:"Use the CLI to Extract Snippets"}),"\n",(0,a.jsxs)(n.p,{children:["After you annotate your code examples with Bluehawk tags, use the\nBluehawk CLI to parse the content. The CLI generates output files that contain\nonly the content you specify. The Bluehawk CLI accepts various\n",(0,a.jsx)(n.a,{href:"/reference/cli",children:"commands"})," to generate output in the way you want it."]}),"\n",(0,a.jsxs)(n.p,{children:["The most common command you'll use is ",(0,a.jsx)(n.code,{children:"bluehawk snip"}),". When you snip code\nblocks, you pass the output directory and the input file or directory."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"bluehawk snip -o <output-directory> <input-directory-or-file>\n"})}),"\n",(0,a.jsx)(n.h3,{id:"extract-code-from-a-single-file",children:"Extract Code from a Single File"}),"\n",(0,a.jsx)(n.p,{children:"If you're just updating a single code example or tutorial, you can extract\ncode from a single file:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"bluehawk snip -o source/examples/generated/code/start/ examples/ios/Examples/ReadWriteData.swift\n"})}),"\n",(0,a.jsxs)(n.p,{children:["This example extracts code snippets from the ",(0,a.jsx)(n.code,{children:"ReadWriteData.swift"})," file, and\ngenerates output files in ",(0,a.jsx)(n.code,{children:"source/examples/generated/code/start/"}),"."]}),"\n",(0,a.jsx)(n.h3,{id:"extract-code-in-a-directory",children:"Extract Code in a Directory"}),"\n",(0,a.jsx)(n.p,{children:"If you want to generate Bluehawk output for all the files in a directory,\nyou can pass a directory as an input source:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-shell",children:"bluehawk snip -o source/examples/generated/code/start/ examples/ios/Examples\n"})}),"\n",(0,a.jsxs)(n.p,{children:["In this example, ",(0,a.jsx)(n.code,{children:"examples/ios/examples"})," is the directory that contains all\nof the Realm docs iOS unit test files. If we create new test files, or\nchange existing tests, and then run this command, Bluehawk generates\nnew or updated output files for all changes."]}),"\n",(0,a.jsx)(n.admonition,{type:"tip",children:(0,a.jsxs)(n.p,{children:["Make an ",(0,a.jsx)(n.a,{href:"https://www.geeksforgeeks.org/alias-command-in-linux-with-examples/",children:"alias"}),"\nfor common Bluehawk commands. If you find yourself always running the same\n",(0,a.jsx)(n.code,{children:"bluehawk snip"})," command with the same input and output directories, make\nit a command-line alias. I have ",(0,a.jsx)(n.code,{children:"bluehawkify"})," and ",(0,a.jsx)(n.code,{children:"bluehawkify-android"})," as\naliases for common Bluehawk CLI commands."]})}),"\n",(0,a.jsx)(n.h2,{id:"include-the-snippets-in-your-documentation",children:"Include the Snippets In Your Documentation"}),"\n",(0,a.jsx)(n.p,{children:"After annotating code examples and extracting them with the Bluehawk CLI,\nyou've got code files in an output directory."}),"\n",(0,a.jsx)(n.p,{children:"Now it's time to include those code blocks in your documentation.\nHow you do that depends on your documentation tooling."}),"\n",(0,a.jsxs)(n.p,{children:["In Realm documentation, our build system uses reStructured Text (rST), which\n",(0,a.jsxs)(n.a,{href:"https://docutils.sourceforge.io/docs/ref/rst/directives.html#include",children:["has an ",(0,a.jsx)(n.code,{children:"include"})," option"]}),"\nthat looks like:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:".. literalinclude:: /examples/generated/code/start/ReadWriteData.snippet.models.swift\n   :language: swift\n"})}),"\n",(0,a.jsxs)(n.p,{children:["In ",(0,a.jsx)(n.a,{href:"https://docusaurus.io/docs/static-assets",children:"Docusaurus"}),", you would ",(0,a.jsx)(n.code,{children:"import"}),"\nthe file from a generated file directory and use it in a special block:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:'import QuickStartTestSnippetUpdateRealmObjectDart from "!!raw-loader!@site/generated/flutter/quick_start_test.snippet.update-realm-object.dart";\n\n<CodeBlock className="language-dart">\n  {QuickStartTestSnippetUpdateRealmObjectDart}\n</CodeBlock>\n'})}),"\n",(0,a.jsx)(n.p,{children:"Consult your documentation tooling for the best way to include external files\nin your documentation set."})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var s=t(6540);const a={},i=s.createContext(a);function r(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);